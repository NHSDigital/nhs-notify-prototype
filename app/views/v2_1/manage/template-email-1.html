{% extends 'v2_1/layout.html' %}

{% block pageScripts %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/showdown/2.1.0/showdown.min.js"></script>
<script>
window.onload = function () {
  var text = document.getElementById('sourceTA').value,
      target = document.getElementById('targetDiv'),
      converter = new showdown.Converter(),
      html = converter.makeHtml(text);
    
    target.innerHTML = html;
}
</script>
{% endblock %}



{% block beforeContent %}

<div class="nhsuk-back-link nhsuk-u-margin-top-4 nhsuk-u-margin-bottom-0">
  <a class="nhsuk-back-link__link" href="/{{ protoVersion }}/manage/create-email-template?mode=edit">
    <svg class="nhsuk-icon nhsuk-icon__chevron-left" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" aria-hidden="true" height="24" width="24">
      <path d="M8.5 12c0-.3.1-.5.3-.7l5-5c.4-.4 1-.4 1.4 0s.4 1 0 1.4L10.9 12l4.3 4.3c.4.4.4 1 0 1.4s-1 .4-1.4 0l-5-5c-.2-.2-.3-.4-.3-.7z"></path>
    </svg>
    Go back
  </a>
</div>

{% endblock %}

{% block content %}
  <div class="nhsuk-grid-row">
    <div class="nhsuk-grid-column-two-thirds">

      <h1 class="nhsuk-heading-xl">
        <span class="nhsuk-caption-l">Email template</span>
        {{ data['template-email-name-1'] }}
      </h1>

      {{ details({
        "text": "Who your email will be sent from",
        html: "
        <p>Set your reply-to and from email addresses during onboarding.</p>
        <p>If you need to set up a different reply-to or from address for other messages, contact our onboarding team.</p>
        "
      }) }}

      <table role="table" class="nhsuk-table-responsive notify-template-content nhsuk-u-margin-bottom-6">
        <tbody class="nhsuk-table__body">

          <!--<tr role="row" class="nhsuk-table__row">
            <th role="cell" class="nhsuk-table__cell">
              From
            </th>
            <td role="cell" class="nhsuk-table__cell">
              [Your organisation or service]
            </td>
          </tr>-->

          <tr role="row" class="nhsuk-table__row">
            <th role="cell" class="nhsuk-table__cell">
              Subject
            </th>
            <td role="cell" class="nhsuk-table__cell">
              {{ data['template-email-subject-1'] }}
            </td>
          </tr>
          <tr role="row" class="nhsuk-table__row">
            <th role="cell" class="nhsuk-table__cell">
              Message
            </th>
            <td role="cell" class="nhsuk-table__cell">
              <textarea id="sourceTA" style="display: none;">{{ data["template-email-message-1"] }}</textarea>
              <div id="targetDiv"></div>
            </td>
          </tr>

        </tbody>
      </table>

      <form action="route-template-next" method="post">

      {{ radios({
        "name": "template-next",
        "fieldset": {
          "legend": {
            "text": "What would you like to do next with this template?",
            "classes": "nhsuk-fieldset__legend--m"
          }
        },
        "items": [
          {
            "value": "edit-email",
            "text": "Edit"
          },
          {
            "value": "approve",
            "text": "Submit"
          }
        ]
      }) }}

      <input type="hidden" name="approve-template-name" value="{{ data['template-email-name-1'] }}">

      {{ button({
        "text": "Continue"
      }) }}

    </form>

    </div>
  </div>
{% endblock %}